
<content>
    <div class="bill">
        <img src="img/vip/title.jpg">
    </div>
    <div class="container">
        <div class="Rosefoot vip">
            <div class="font_today font_vip">会员登录</div>
            <div class="border_vip"></div>
        </div>
        <form class="formLogin" action="#" method="post">
            <input type="text" class="loginInput userInput" name="userName" id="userName" placeholder="帐号" required >
            <input type="password" class="loginInput pswInput" name="psw" id="psw" placeholder="密码" required >
            <input type="submit" class="loginInput submit" value="登录">
            <div class="login">
                <a ui-sref="register">免费注册></a>
            </div>
        </form>
    </div>
</content>
<script type="text/javascript">
    document.forms[0].onsubmit = function(e) {
        e.preventDefault()
        var data = new FormData(this)
        var xhr = new XMLHttpRequest()
        xhr.onreadystatechange = function() {
            if(xhr.readyState == 4) {
                //alert(xhr.responseText)
                var jsonObj = JSON.parse(xhr.responseText)
                if(jsonObj.success == 1){
                    //alert('恭喜你，登录成功！')
                    alert(jsonObj.msg)
                    var username = jsonObj.userName
                    $('.registerHeader').css('display','block')
                    $('header').css('paddingTop','40px')
                    $('.name').html(username)
                }
                else{
                    alert(jsonObj.msg)
                }
            }
        }
        xhr.open('POST', '/user/login')
        xhr.send(data)
    }
</script>